var loadMapConstituency=function(){d3.select("body").transition().on("end",function(){$.getJSON(jsonPath,function(json){for(var i=0;i<json.length-1;++i)
{var parent_node='.parliament .'+json[i].id;$(parent_node).each(function(e){var const_result_detail=json[i].party_detail_result[e];});}});});};var windowWidth=window.innerWidth,parliamentWidth=494,parliamentHeight=315;if(windowWidth<650&&windowWidth>420){parliamentWidth=415;parliamentHeight=215;}else if(windowWidth<419){parliamentWidth=300;parliamentHeight=150;}
var parliament=d3.parliament().width(parliamentWidth).height(parliamentHeight).innerRadiusCoef(0.4),jsonPath=$(".election-tabs li.active a").attr('data-url'),setData=function(d){d3.select($(".election-tabs li.active a").attr('href')+" svg.crtgrm").datum(d).call(parliament);};parliament.enter.fromCenter(true).smallToBig(true);parliament.exit.toCenter(true).bigToSmall(true);d3.json(jsonPath,setData);$(".election-tabs li a").on("click",function(e){jsonPath=$(this).attr('data-url');d3.json(jsonPath,setData);loadMapConstituency();});loadMapConstituency();$(function(){var createSeatsArray=function(prefix,total){var tempArray=[];for(var a=1;a<=total;a++){tempArray.push(prefix+"-"+a);}
return tempArray;},naSeatsArray=createSeatsArray('na',272),psSeatsArray=createSeatsArray('ps',130),pbSeatsArray=createSeatsArray('pb',51),pkSeatsArray=createSeatsArray('pk',99),ppSeatsArray=createSeatsArray('pp',297),finalArray=[];finalArray=finalArray.concat(naSeatsArray,psSeatsArray,pbSeatsArray,pkSeatsArray,ppSeatsArray);$('body .tab_search').on('click','.search-query',function(e){$(".suggestionBox").removeClass("hide");});$(document).on('keyup','.search-query',function(e){var seat=$(this).val(),seatPrefix=seat.toString().toLowerCase().substring(0,2);$(".load_ele_suggestion").removeClass('hide');var resultArray=$.grep(finalArray,function(value,i){seat=seat.toString().toUpperCase();if(seat.substr(2,1)!="-"){seat=seat.substr(0,2)+"-"+seat.substr(2,seat.length);}
return value.toUpperCase().indexOf(seat)>=0;});var ulEle=$("<ul></ul>");var siliceCount=5;if(resultArray.length<10){siliceCount=resultArray.length;}
if(resultArray.length>0){$.each(resultArray.slice(0,siliceCount),function(i,v){var liEle=$("<li></li>");var aEle=$("<a></a>");aEle.attr({'data-seat':v,"href":'javascript:void(0)','class':'getSuggestionSeatData'});aEle.text(v.toString().toUpperCase());liEle.html(aEle);ulEle.append(liEle);});}
$(".suggestionBox").html(ulEle);$(".suggestionBox").removeClass("hide");});$(document).on("click",".getSuggestionSeatData",function(){var ele=$(this),seat=ele.attr('data-seat').toString().toUpperCase();if(ele.parents(".constituency-desctiption-area").hasClass("constituency-desctiption-area")){window.location.href=BaseURL+'election/'+seat;return;}
$(".tab_box_list .load_ele").removeClass('hide');var url=BaseURL+'election/election_constituency_result';$.ajax({url:url,type:'post',data:{'seat':seat},success:function(response){$(".tab_box_list").find(".na-results-box").html(response);},complete:function(event,xhr){$(".tab_box_list .load_ele").addClass('hide');$(".suggestionBox").addClass("hide");$('body .tab_search .search-query').val(seat);}});});$('.map-na svg #Pak_NA_Hex').on('click touchstart','path',function(e){var ele=$(this),seat=ele.attr('id');var seatPrefix=seat.toString().toLowerCase().substring(0,2);if(seatPrefix=='na'||seatPrefix=='ps'||seatPrefix=='pp'||seatPrefix=='pb'||seatPrefix=='pk'){$(".tab_box_list .load_ele").removeClass('hide');var url=BaseURL+'election/election_constituency_result';$('.map-na svg #Pak_NA_Hex').find("path").removeAttr("class");$.ajax({url:url,type:'post',data:{'seat':seat},success:function(response){$(".tab_box_list").find(".na-results-box").html(response);},complete:function(event,xhr){$(".tab_box_list .load_ele").addClass('hide');$("body,html").animate({scrollTop:($('body .tab_search .search').offset().top-100)+"px"},'slow');ele.attr("class","activePath");}});}});$.getJSON(jsonPath,function(json){for(var i=0;i<json.length-1;++i)
for(var j=0;j<json[i].party_detail_result.length;++j)
{var nodeData=json[i].party_detail_result[j];var nodeResultData=nodeData.candidate_name+'<br>'+nodeData.constituency_complete_name+'<br>'+nodeData.party_complete_name;$('.map-na svg #Pakistan #'+nodeData.constituency_short_name).attr('title-result',nodeData.constituency_short_name);}});var targets=$('[rel~=tooltip]'),target=false,tooltip=false,title=false,windowWidth=$(window).width();if(windowWidth>990){$('.map-na svg #Pak_NA_Hex').on('mouseenter','path',function(e){target=$(this);tip=target.attr('id');tooltip=$('<div id="tooltip"></div>');if(!tip||tip=='')
return false;target.removeAttr('title');tooltip.addClass("fixed-tip")
tooltip.css('opacity',0).html(tip).appendTo('body');var init_tooltip=function(){if($(window).width()<tooltip.outerWidth()*1.5)
tooltip.css('max-width',$(window).width()/2);else
tooltip.css('max-width',340);var pos_left=e.clientX-20,pos_top=e.clientY-50;tooltip.css({left:pos_left,top:pos_top}).animate({top:'+=10',opacity:1},50);};init_tooltip();$(window).resize(init_tooltip);var remove_tooltip=function(){tooltip.animate({top:'-=10',opacity:0},100,function(){$(this).remove();});target.attr('title',tip);};target.bind('mouseleave',remove_tooltip);tooltip.bind('click',remove_tooltip);if(windowWidth<=767){$(this).trigger("click");}});}
$(window).scroll(function(){$("#tooltip").remove();});$(document).on('mouseenter','.map-inner svg .parliament circle',function(e){target=$(this);tip=target.attr('data-constituency');tooltip=$('<div id="tooltip"></div>');if(!tip||tip=='')
return false;target.removeAttr('title');tooltip.css('opacity',0).html(tip).appendTo('body');var init_tooltip=function(){if($(window).width()<tooltip.outerWidth()*1.5)
tooltip.css('max-width',$(window).width()/2);else
tooltip.css('max-width',340);var pos_left=target.offset().left+(target.outerWidth()/2)-(tooltip.outerWidth()/2),pos_top=target.offset().top-tooltip.outerHeight()-20;if(pos_left<0){pos_left=target.offset().left+target.outerWidth()/2-20;tooltip.addClass('left');}
else
tooltip.removeClass('left');if(pos_left+tooltip.outerWidth()>$(window).width()){pos_left=target.offset().left-tooltip.outerWidth()+target.outerWidth()/2+20;tooltip.addClass('right');}
else
tooltip.removeClass('right');if(pos_top<0){var pos_top=target.offset().top+target.outerHeight();tooltip.addClass('top');}
else
tooltip.removeClass('top');tooltip.css({left:pos_left,top:pos_top}).animate({top:'+=10',opacity:1},50);};init_tooltip();$(window).resize(init_tooltip);var remove_tooltip=function(){tooltip.animate({top:'-=10',opacity:0},100,function(){$(this).remove();});target.attr('title',tip);};target.bind('mouseleave',remove_tooltip);tooltip.bind('click',remove_tooltip);if(windowWidth<=767){$(this).trigger("click");}});var countDownDate=new Date("Jul 25, 2018 08:00:00").getTime();var countDownDateEnd=new Date("Jul 25, 2018 18:00:00").getTime();var x=setInterval(function(){if(typeof $("#pollingTimer").attr("id")!=="undefined"||typeof $("#pollingTimerEnd").attr("id")!=="undefined"){var now=new Date().getTime();var distance=countDownDate-now;var distanceEnd=countDownDateEnd-now;var days=Math.floor(distance/(1000*60*60*24));var hours=Math.floor((distance%(1000*60*60*24))/(1000*60*60));var minutes=Math.floor((distance%(1000*60*60))/(1000*60));var seconds=Math.floor((distance%(1000*60))/1000);var daysEnd=Math.floor(distanceEnd/(1000*60*60*24));var hoursEnd=Math.floor((distanceEnd%(1000*60*60*24))/(1000*60*60));var minutesEnd=Math.floor((distanceEnd%(1000*60*60))/(1000*60));var secondsEnd=Math.floor((distanceEnd%(1000*60))/1000);if(typeof $("#pollingTimer").attr("id")!=="undefined"){document.getElementById("pollingTimer").innerHTML=hours+"h "
+minutes+"m "+seconds+"s ";}
if(typeof $("#pollingTimerEnd").attr("id")!=="undefined"){document.getElementById("pollingTimerEnd").innerHTML=hoursEnd+"h "
+minutesEnd+"m "+secondsEnd+"s ";}
if(distance<0){if(typeof $("#pollingTimer").attr("id")!=="undefined"){document.getElementById("pollingTimer").remove();}}
if(distanceEnd<0){if(typeof $("#pollingTimerEnd").attr("id")!=="undefined"){document.getElementById("pollingTimerEnd").remove();}}}else{clearTimeout(x);}},1000);});